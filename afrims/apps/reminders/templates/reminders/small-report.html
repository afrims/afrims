{% extends "reminders/base.html" %}

{% block right %}
{% load pagination_tags sorting_tags %}
{% autosort patients %}
{% autopaginate patients 20 %}
<h1>{{ status|capfirst }} Appointment Report</h1>
<h2>For Appointments on {{ appt_date }}</h2>
<div class="module">
    <table class="pagination sortable patient-reminders">
        <thead>
            <tr>
                <th>{% anchor subject_number "Study ID" %}</th>                
                <th>{% anchor mobile_number "Number" %}</th>
                {% if status == 'confirmed' %}
                    <th>{% anchor confirm_time "Time Confirmed" %}</th>
                {% else %}
                    <th>{% anchor last_reminder_time "Time of Last Reminder" %}</th>
                {% endif %}
            </tr>
        </thead>
        {% for patient in patients %}
        <tr class="{% cycle 'odd' 'even' %}">
            <td>{{ patient.subject_number }}</td>
            <td>{{ patient.mobile_number }}</td>
            {% if status == 'confirmed' %}
                <td>{{ patient.confirm_time }}</td>
            {% else %}
                <td>{{ patient.last_reminder_time }}</td>
            {% endif %}
        </tr>
        {% empty %}
        <tr>
            <td colspan='3'>No pending reminders</td>
        </tr>
        {% endfor %}
        <tfoot>
            {% if paginator.count > paginator.per_page %}
            <tr>
                <td colspan='3'>
                    {% paginate %}
                </td>
            </tr>
            {% endif %}
        </tfoot>
    </table>
</div>
<div class="module">
    <form class="date-form buttons" action="{% url reminders-report %}" method="get">
        <div class='form-action'>
            {{ report_form }}
            <input type='hidden' name="status" value="{{ status }}" />
            <input type='submit' value="Change Report Date" />
        </div>
    </form>
</div>
{% endblock %}
